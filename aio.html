<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Data Organization in Spreadsheets for Ecologists: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="assets/images/data-logo.svg">
</div>
    </div>
    <div class="selector-container ">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="assets/images/data-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Data Organization in Spreadsheets for Ecologists
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Data Organization in Spreadsheets for Ecologists
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Organization in Spreadsheets for Ecologists
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-intro.html">1. Introduction</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-format-data.html">2. Formatting data tables in Spreadsheets</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-common-mistakes.html">3. Formatting problems</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-dates-as-data.html">4. Dates as data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-quality-control.html">5. Quality control</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-exporting-data.html">6. Exporting data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li>
<li><a href="reference.html">Glossary</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-intro"><p>Content from <a href="00-intro.html">Introduction</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/edit/main/episodes/00-intro.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are basic principles for using spreadsheets for good data
organization?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe best practices for organizing data so computers can make
the best use of data sets.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Good data organization is the foundation of your research project.
Most researchers have data or do data entry in spreadsheets. Spreadsheet
programs are very useful graphical interfaces for designing data tables
and handling very basic data quality control functions.</p>
<div class="section level3">
<h3 id="spreadsheet-outline">Spreadsheet outline<a class="anchor" aria-label="anchor" href="#spreadsheet-outline"></a>
</h3>
<p>After this lesson, you will be able to:</p>
<ul>
<li>Implement best practices in data table formatting</li>
<li>Identify and address common formatting mistakes</li>
<li>Understand approaches for handling dates in spreadsheets</li>
<li>Utilize basic quality control features and data manipulation
practices</li>
<li>Effectively export data from spreadsheet programs</li>
</ul>
<p><em>Overall good data practices</em></p>
<p>Spreadsheets are good for data entry. Therefore we have a lot of data
in spreadsheets. Much of your time as a researcher will be spent in this
‘data wrangling’ stage. It’s not the most fun, but it’s necessary. We’ll
teach you how to think about data organization and some practices for
more effective data wrangling. Not only will this save time and effort,
it also paves the way for more equitable and inclusive science. Making
our work more accessible provides wider avenues for collaboration and
improvement!</p>
</div>
<div class="section level3">
<h3 id="what-this-lesson-will-not-teach-you">What this lesson will not teach you<a class="anchor" aria-label="anchor" href="#what-this-lesson-will-not-teach-you"></a>
</h3>
<ul>
<li>How to do <em>statistics</em> in a spreadsheet</li>
<li>How to do <em>plotting</em> in a spreadsheet</li>
<li>How to <em>write code</em> in spreadsheet programs</li>
</ul>
<p>If you’re looking to do this, a good reference is <a href="https://www.amazon.com/Head-First-Excel-learners-spreadsheets/dp/0596807694/" class="external-link">Head
First Excel</a>, published by O’Reilly.</p>
<hr>
</div>
<div class="section level3">
<h3 id="why-arent-we-teaching-data-analysis-in-spreadsheets">Why aren’t we teaching data analysis in spreadsheets<a class="anchor" aria-label="anchor" href="#why-arent-we-teaching-data-analysis-in-spreadsheets"></a>
</h3>
<ul>
<li><p>Data analysis in spreadsheets usually requires a lot of manual
work. If you want to change a parameter or run an analysis with a new
dataset, you usually have to redo everything by hand. (We do know that
you can create macros, but see the next point.)</p></li>
<li><p>It is also difficult to track or reproduce statistical or
plotting analyses done in spreadsheet programs when you want to go back
to your work or someone asks for details of your analysis.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="spreadsheet-programs">Spreadsheet programs<a class="anchor" aria-label="anchor" href="#spreadsheet-programs"></a>
</h3>
<p>Many spreadsheet programs are available. Since most participants
utilize Excel as their primary spreadsheet program, this lesson will
make use of Excel examples.</p>
<p>Free spreadsheet programs that can also be used are LibreOffice Calc,
and even Google Sheets.</p>
<p>Commands may differ a bit between programs, but the general idea is
the same.</p>
<div id="exercise" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<ul>
<li>How many people have used spreadsheets in their research?</li>
<li>How many people have accidentally done something that made them
frustrated or sad?</li>
</ul>
</div>
</div>
</div>
<p>Spreadsheets encompass a lot of the things we need to be able to do
as researchers. We can use them for:</p>
<ul>
<li>Data entry</li>
<li>Organizing data</li>
<li>Subsetting and sorting data</li>
<li>Statistics</li>
<li>Plotting</li>
</ul>
<p>We do a lot of different operations in spreadsheets. What kind of
operations do you do in spreadsheets? Which ones do you think
spreadsheets are good for?</p>
</div>
<section id="problems-with-spreadsheets"><h2 class="section-heading">Problems with Spreadsheets<a class="anchor" aria-label="anchor" href="#problems-with-spreadsheets"></a>
</h2>
<hr class="half-width">
<p>Spreadsheets are good for data entry, but in reality we tend to use
spreadsheet programs for much more than data entry. We use them to
create data tables for publications, to generate summary statistics, and
make figures.</p>
<p>Generating tables for publications in a spreadsheet is not optimal -
often, when formatting a data table for publication, we’re reporting key
summary statistics in a way that is not really meant to be read as data,
and often involves special formatting (merging cells, creating borders,
making it pretty). Cutting and pasting from a spreadsheet to a document
software (like Word) can have unpredictable results. We advise you to
create tables within these document software using the document’s own
table editing software.</p>
<p>The latter two applications, generating statistics and figures,
should be used with caution: because of the graphical, drag and drop
nature of spreadsheet programs, it can be very difficult, if not
impossible, to replicate your steps (much less retrace anyone else’s),
particularly if your stats or figures require you to do more complex
calculations. Furthermore, in doing calculations in a spreadsheet, it’s
easy to accidentally apply a slightly different formula to multiple
adjacent cells. When using a command-line based statistics program like
R or SAS, it’s practically impossible to apply a calculation to one
observation in your dataset but not another unless you’re doing it on
purpose.</p>
<div class="section level3">
<h3 id="using-spreadsheets-for-data-entry-and-cleaning">Using Spreadsheets for Data Entry and Cleaning<a class="anchor" aria-label="anchor" href="#using-spreadsheets-for-data-entry-and-cleaning"></a>
</h3>
<p>However, there are circumstances where you might want to use a
spreadsheet program to produce “quick and dirty” calculations or
figures, and data cleaning will help you use some of these features.
Data cleaning also puts your data in a better format prior to
importation into a statistical analysis program. We will show you how to
use some features of spreadsheet programs to check your data quality
along the way and produce preliminary summary statistics.</p>
<p>In this lesson, we will assume that you are most likely using Excel
as your primary spreadsheet program - there are others (gnumeric, Calc
from OpenOffice), and their functionality is similar, but Excel seems to
be the program most used by biologists and ecologists.</p>
<p>In this lesson we’re going to talk about:</p>
<ol style="list-style-type: decimal">
<li><a href="01-format-data.html">Formatting data tables in
spreadsheets</a></li>
<li><a href="02-common-mistakes.html">Formatting problems</a></li>
<li><a href="03-dates-as-data.html">Dates as data</a></li>
<li><a href="04-quality-control.html">Quality control</a></li>
<li><a href="05-exporting-data.html">Exporting data</a></li>
</ol>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Good data organization is the foundation of any research
project.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-01-format-data"><p>Content from <a href="01-format-data.html">Formatting data tables in Spreadsheets</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/edit/main/episodes/01-format-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we format data in spreadsheets for effective data use?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe best practices for data entry and formatting in
spreadsheets.</li>
<li>Apply best practices to arrange variables and observations in a
spreadsheet.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The most common mistake made is treating spreadsheet programs like
lab notebooks, that is, relying on context, notes in the margin, spatial
layout of data and fields to convey information. As humans, we can
(usually) interpret these things, but computers don’t view information
the same way, and unless we explain to the computer what every single
thing means (and that can be hard!), it will not be able to see how our
data fits together.</p>
<p>Using the power of computers, we can manage and analyze data in much
more effective and faster ways, but to use that power, we have to set up
our data for the computer to be able to understand it (and computers are
very literal).</p>
<p>This is why it’s extremely important to set up well-formatted tables
from the outset - before you even start entering data from your very
first preliminary experiment. Data organization is the foundation of
your research project. It can make it easier or harder to work with your
data throughout your analysis, so it’s worth thinking about when you’re
doing your data entry or setting up your experiment. You can set things
up in different ways in spreadsheets, but some of these choices can
limit your ability to work with the data in other programs or have the
you-of-6-months-from-now or your collaborator work with the data.</p>
<div id="note" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h3>
<div class="callout-content">
<p>The best layouts/formats (as well as software and interfaces) for
data entry and data analysis might be different. It is important to take
this into account, and ideally automate the conversion from one to
another.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="keeping-track-of-your-analyses">Keeping track of your analyses<a class="anchor" aria-label="anchor" href="#keeping-track-of-your-analyses"></a>
</h3>
<p>When you’re working with spreadsheets, during data clean up or
analyses, it’s very easy to end up with a spreadsheet that looks very
different from the one you started with. In order to be able to
reproduce your analyses or figure out what you did when Reviewer #3 asks
for a different analysis, you should</p>
<ul>
<li>create a new file with your cleaned or analyzed data. Don’t modify
the original dataset, or you will never know where you started!</li>
<li>keep track of the steps you took in your clean up or analysis. You
should track these steps as you would any step in an experiment. We
recommend that you do this in a plain text file stored in the same
folder as the data file.</li>
</ul>
<p>This might be an example of a spreadsheet setup:</p>
<figure><img src="fig/spreadsheet-setup-updated.png" alt="spreadsheet setup" class="figure mx-auto d-block"></figure><p>Put these principles in to practice today during your Exercises.</p>
<div id="note-1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note-1" class="callout-inner">
<h3 class="callout-title">Note<a class="anchor" aria-label="anchor" href="#note-1"></a>
</h3>
<div class="callout-content">
<p>This is out of scope for this lesson, but for information on how to
maintain version control over your data, look at our lesson on <a href="https://swcarpentry.github.io/git-novice/" class="external-link">‘Git’</a>.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="structuring-data-in-spreadsheets">Structuring data in spreadsheets<a class="anchor" aria-label="anchor" href="#structuring-data-in-spreadsheets"></a>
</h3>
<p>The cardinal rule of using spreadsheet programs for data is to keep
it “tidy”:</p>
<ol style="list-style-type: decimal">
<li>Put all your variables in columns - the thing you’re measuring, like
‘weight’ or ‘temperature’.</li>
<li>Put each observation in its own row.</li>
<li>Don’t combine multiple pieces of information in one cell. Sometimes
it just seems like one thing, but think if that’s the only way you’ll
want to be able to use or sort that data.</li>
<li>Leave the raw data raw - don’t change it!</li>
<li>Export the cleaned data to a text-based format like CSV
(comma-separated values) format. This ensures that anyone can use the
data, and is required by most data repositories.</li>
</ol>
<p>For instance, we have data from a survey of small mammals in a desert
ecosystem. Different people have gone to the field and entered data into
a spreadsheet. They keep track of things like species, plot, weight, sex
and date collected.</p>
<p>If they were to keep track of the data like this:</p>
<figure><img src="fig/multiple-info.png" alt="multiple-info example" class="figure mx-auto d-block"></figure><p>the problem is that species and sex are in the same field. So, if
they wanted to look at all of one species or look at different weight
distributions by sex, it would be hard to do this using this data setup.
If instead we put sex and species in different columns, you can see that
it would be much easier.</p>
</div>
<div class="section level3">
<h3 id="columns-for-variables-and-rows-for-observations">Columns for variables and rows for observations<a class="anchor" aria-label="anchor" href="#columns-for-variables-and-rows-for-observations"></a>
</h3>
<p>The rule of thumb, when setting up a datasheet, is columns =
variables, rows = observations, cells = data (values).</p>
<p>So, instead we should have:</p>
<figure><img src="fig/single-info.png" alt="single-info example" class="figure mx-auto d-block"></figure><div id="discussion" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="discussion" class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h3>
<div class="callout-content">
<p>If not already discussed, introduce the dataset that will be used in
this lesson, and in the other ecology lessons, the <a href="https://www.datacarpentry.org/ecology-workshop/data/" class="external-link">Portal
Project Teaching Dataset</a>.</p>
<p>The data used in the ecology lessons are observations of a small
mammal community in southern Arizona. This is part of a project studying
the effects of rodents and ants on the plant community that has been
running for almost 40 years. The rodents are sampled on a series of 24
plots, with different experimental manipulations controlling which
rodents are allowed to access which plots.</p>
<p>This is a real dataset that has been used in over 100 publications.
We’ve simplified it just a little bit for the workshop, but you can
download the full dataset and work with it using exactly the same tools
we’ll learn about today.</p>
</div>
</div>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>We’re going to take a messy version of the survey data and describe
how we would clean it up.</p>
<ol style="list-style-type: decimal">
<li>Download the data by clicking <a href="https://ndownloader.figshare.com/files/2252083" class="external-link">here</a> to get it
from FigShare.</li>
<li>Open up the data in a spreadsheet program.</li>
<li>You can see that there are two tabs. Two field assistants conducted
the surveys, one in 2013 and one in 2014, and they both kept track of
the data in their own way in tabs <code>2013</code> and
<code>2014</code> of the dataset, respectively. Now you’re the person in
charge of this project and you want to be able to start analyzing the
data.</li>
<li>With the person next to you, identify what is wrong with this
spreadsheet. Also discuss the steps you would need to take to clean up
the <code>2013</code> and <code>2014</code> tabs, and to put them all
together in one spreadsheet.</li>
</ol>
<p><strong>Important</strong> Do not forget our first piece of advice:
to create a new file (or tab) for the cleaned data, never modify your
original (raw) data.</p>
<p>After you go through this exercise, we’ll discuss as a group what was
wrong with this data and how you would fix it.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ul>
<li>Take about 10 minutes to work on this exercise.</li>
<li>All the mistakes in <a href="02-common-mistakes.html">02-common-mistakes</a> are present in the
messy dataset. If the exercise is done during a workshop, ask people
what they saw as wrong with the data. As they bring up different points,
you can refer to <a href="02-common-mistakes.html">02-common-mistakes</a> or expand a bit on
the point they brought up.</li>
<li>Note that there is a problem with dates in table ‘plot 3’ in
<code>2014</code> tab. The field assistant who collected the data for
year 2014 initially forgot to include their data for ‘plot 3’. They came
back in 2015 to include the missing data and entered the dates for ‘plot
3’ in the dataset without the year. Excel automatically filled in the
missing year as the current year (i.e. 2015) - introducing an error in
the data without the field assistant realising. If you get a response
from the participants that they’ve spotted and fixed the problem with
date, you can say you’ll come back to dates again towards the end of
lesson in episode <a href="03-dates-as-data.html">03-dates-as-data</a>.
If participants have not spotted the problem with dates in ‘plot 3’
table, that’s fine as you will address peculiarities of working with
dates in spreadsheets in episode <a href="03-dates-as-data.html">03-dates-as-data</a>.</li>
</ul>
</div>
</div>
</div>
</div>
<p>There are excellent references to help you work with data in
spreadsheets. These include:</p>
<p>Regarding R scripting;</p>
<blockquote>
<p>Hadley Wickham, <em>Tidy Data</em>, Vol. 59, Issue 10, Sep 2014,
Journal of Statistical Software. <a href="https://www.jstatsoft.org/v59/i10" class="external-link">http://www.jstatsoft.org/v59/i10</a>.</p>
</blockquote>
<p>Appropriately Regarding Data organization in spreadsheets;</p>
<blockquote>
<p>Karl W. Broman &amp; Kara H. Woo (2018) Data Organization in
Spreadsheets, The American Statistician, 72:1, 2-10, <a href="https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1375989" class="external-link">DOI:
10.1080/00031305.2017.1375989</a>.</p>
</blockquote>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Never modify your raw data. Always make a copy before making any
changes.</li>
<li>Keep track of all of the steps you take to clean your data in a
plain text file.</li>
<li>Organize your data according to tidy data principles.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-02-common-mistakes"><p>Content from <a href="02-common-mistakes.html">Formatting problems</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/edit/main/episodes/02-common-mistakes.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are some common challenges with formatting data in spreadsheets
and how can we avoid them?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Recognize and resolve common spreadsheet formatting problems.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="common-spreadsheet-errors"><h2 class="section-heading">Common Spreadsheet Errors<a class="anchor" aria-label="anchor" href="#common-spreadsheet-errors"></a>
</h2>
<hr class="half-width">
<p>This episode is meant to be used as a reference for discussion as
learners identify issues with the messy dataset discussed in the
previous episode. Instructors: don’t go through this episode except to
refer to responses to the exercise in the previous episode.</p>
<p>There are a few potential errors to be on the lookout for in your own
data as well as data from collaborators or the Internet. If you are
aware of the errors and the possible negative effect on downstream data
analysis and result interpretation, it might motivate yourself and your
project members to try and avoid them. Making small changes to the way
you format your data in spreadsheets can have a great impact on
efficiency and reliability when it comes to data cleaning and
analysis.</p>
<ul>
<li><a href="#tables">Using multiple tables</a></li>
<li><a href="#tabs">Using multiple tabs</a></li>
<li><a href="#zeros">Not filling in zeros</a></li>
<li><a href="#null">Using problematic null values</a></li>
<li><a href="#formatting">Using formatting to convey
information</a></li>
<li><a href="#formatting-pretty">Using formatting to make the data sheet
look pretty</a></li>
<li><a href="#units">Placing comments or units in cells</a></li>
<li><a href="#info">Entering more than one piece of information in a
cell</a></li>
<li><a href="#field-name">Using problematic field names</a></li>
<li><a href="#special">Using special characters in data</a></li>
<li><a href="#metadata">Inclusion of metadata in data table</a></li>
<li><a href="03-dates-as-data.html">Date formatting</a></li>
</ul></section><section id="tables"><h2 class="section-heading">Using multiple tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h2>
<hr class="half-width">
<p>A common strategy is creating multiple data tables within one
spreadsheet. This confuses the computer, so don’t do this! When you
create multiple tables within one spreadsheet, you’re drawing false
associations between things for the computer, which sees each row as an
observation. You’re also potentially using the same field name in
multiple places, which will make it harder to clean your data up into a
usable form. The example below depicts the problem:</p>
<figure><img src="fig/2_datasheet_example.jpg" alt="multiple tabs" class="figure mx-auto d-block"></figure><p>In the example above, the computer will see (for example) row 4 and
assume that all columns A-AF refer to the same sample. This row actually
represents four distinct samples (sample 1 for each of four different
collection dates - May 29th, June 12th, June 19th, and June 26th), as
well as some calculated summary statistics (an average (avr) and
standard error of measurement (SEM)) for two of those samples. Other
rows are similarly problematic.</p>
</section><section id="tabs"><h2 class="section-heading">Using multiple tabs<a class="anchor" aria-label="anchor" href="#tabs"></a>
</h2>
<hr class="half-width">
<p>But what about workbook tabs? That seems like an easy way to organize
data, right? Well, yes and no. When you create extra tabs, you fail to
allow the computer to see connections in the data that are there (you
have to introduce spreadsheet application-specific functions or
scripting to ensure this connection). Say, for instance, you make a
separate tab for each day you take a measurement.</p>
<p>This isn’t good practice for two reasons:</p>
<ol style="list-style-type: decimal">
<li>you are more likely to accidentally add inconsistencies to your data
if each time you take a measurement, you start recording data in a new
tab, and</li>
<li>even if you manage to prevent all inconsistencies from creeping in,
you will add an extra step for yourself before you analyze the data
because you will have to combine these data into a single datatable. You
will have to explicitly tell the computer how to combine tabs - and if
the tabs are inconsistently formatted, you might even have to do it
manually.</li>
</ol>
<p>The next time you’re entering data, and you go to create another tab
or table, ask yourself if you could avoid adding this tab by adding
another column to your original spreadsheet. We used multiple tabs in
our example of a messy data file, but now you’ve seen how you can
reorganize your data to consolidate across tabs.</p>
<p>Your data sheet might get very long over the course of the
experiment. This makes it harder to enter data if you can’t see your
headers at the top of the spreadsheet. But don’t repeat your header row.
These can easily get mixed into the data, leading to problems down the
road.</p>
<p>Instead you can freeze the column headers so that they remain visible
even when you have a spreadsheet with many rows.</p>
<p><a href="https://support.office.com/en-ca/article/Freeze-column-headings-for-easy-scrolling-57ccce0c-cf85-4725-9579-c5d13106ca6a" class="external-link">Documentation
on how to freeze column headers in MS Excel</a></p>
</section><section id="zeros"><h2 class="section-heading">Not filling in zeros<a class="anchor" aria-label="anchor" href="#zeros"></a>
</h2>
<hr class="half-width">
<p>It might be that when you’re measuring something, it’s usually a
zero, say the number of times a rabbit is observed in the survey. Why
bother writing in the number zero in that column, when it’s mostly
zeros?</p>
<p>However, there’s a difference between a zero and a blank cell in a
spreadsheet. To the computer, a zero is actually data. You measured or
counted it. A blank cell means that it wasn’t measured and the computer
will interpret it as an unknown value (otherwise known as a null
value).</p>
<p>The spreadsheets or statistical programs will likely mis-interpret
blank cells that you intend to be zeros. By not entering the value of
your observation, you are telling your computer to represent that data
as unknown or missing (null). This can cause problems with subsequent
calculations or analyses. For example, the average of a set of numbers
which includes a single null value is always null (because the computer
can’t guess the value of the missing observations). Because of this,
it’s very important to record zeros as zeros and truly missing data as
nulls.</p>
</section><section id="null"><h2 class="section-heading">Using problematic null values<a class="anchor" aria-label="anchor" href="#null"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: using -999, other numerical values, zero,
or text to represent missing values. Whatever the reason, it’s a problem
if unknown or missing data is recorded as -999, 999, or 0. Many
statistical programs will not recognize that these are intended to
represent missing (null) values.</p>
<p>How these values are interpreted will depend on the software you use
to analyze your data.</p>
<p><strong>Solutions</strong>:</p>
<p>A solution will depend on the final application of your data and how
you intend to analyze it, but it is essential to use a clearly defined
and CONSISTENT null indicator. Blank cells are the best choices for most
applications; when working in R, <code>NA</code> may be an acceptable
null value choice.</p>
<p>There are a many reasons why null values get represented differently
within a dataset. Sometimes confusing null values are automatically
recorded from the measuring device. If that’s the case, there’s not much
you can do, but it can be addressed in data cleaning with a tool like <a href="https://www.datacarpentry.org/OpenRefine-ecology-lesson/" class="external-link">OpenRefine</a>
before analyzing or sharing. In other cases, null values are used to
convey different reasons why the data is missing. This is important
information to capture, but is actually using one column to capture two
pieces of information. Like for <a href="#formatting">using formatting
to convey information</a> it would be good here to create a new column
like ‘data_missing’ and use that column to capture the different
reasons.</p>
<p>Whatever the reason, missing data is a problem. It is essential to
use a clearly defined and consistent null indicator. Blanks (most
applications) and NA (for R) are good choices. White et al, 2013,
explain good choices for indicating null values for different software
applications in their article: <a href="https://peerj.com/preprints/7/" class="external-link">Nine simple ways to make it easier
to (re)use your data.</a> Ideas in Ecology and Evolution.</p>
<table align="left" style="width =50%; border: 1px solid black;" class="table">
<tr>
<td>
<b>Null Values</b>
</td>
<br><td>
<b>Problems </b>
</td>
<br><td>
<b>Compatibility </b>
</td>
<br><td>
<b>Recommendation </b>
</td>
<br>
</tr>
<tr>
<td>
0
</td>
<td>
Indistinguishable from a true zero
</td>
<td>
</td>
<td>
Never use
</td>
</tr>
<tr>
<td>
Blank
</td>
<td>
Hard to distinguish values that are missing from those overlooked on
entry. Hard to distinguish blanks from spaces, which behave differently
</td>
<td>
R, Python, SQL
</td>
<td>
Best Option
</td>
</tr>
<tr>
<td>
-999, 999
</td>
<td>
Not recognized as null by many programs without user input. Can be
inadvertently entered into calculations
</td>
<td>
</td>
<td>
Avoid
</td>
</tr>
<tr>
<td>
NA, na
</td>
<td>
Can also be an abbreviation (e.g., North America), can cause problems
with data type (turn a numerical column into a text column). NA is more
commonly recognized than na.
</td>
<td>
R
</td>
<td>
Good Option
</td>
</tr>
<tr>
<td>
N/A
</td>
<td>
Alternative form of NA, but often not compatible with software
</td>
<td>
</td>
<td>
Avoid
</td>
</tr>
<tr>
<td>
NULL
</td>
<td>
Can cause problem with data type
</td>
<td>
</td>
<td>
Avoid
</td>
</tr>
<tr>
<td>
None
</td>
<td>
Uncommon. Can cause problem with data type.
</td>
<td>
Python
</td>
<td>
Avoid
</td>
</tr>
<tr>
<td>
No data
</td>
<td>
Uncommon. Can cause problem with data type, Contains a space
</td>
<td>
</td>
<td>
Avoid
</td>
</tr>
<tr>
<td>
Missing
</td>
<td>
Uncommon. Can cause problem with data type.
</td>
<td>
</td>
<td>
Avoid
</td>
</tr>
<tr>
<td>
-,+,.
</td>
<td>
Uncommon. Can cause problem with data type.
</td>
<td>
</td>
<td>
Avoid
</td>
</tr>
</table></section><section id="formatting"><h2 class="section-heading">Using formatting to convey information<a class="anchor" aria-label="anchor" href="#formatting"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: highlighting cells, rows or columns that
should be excluded from an analysis, leaving blank rows to indicate
separations in data.</p>
<figure><img src="fig/formatting.png" alt="formatting" class="figure mx-auto d-block"></figure><p><strong>Solution</strong>: create a new field to encode which data
should be excluded.</p>
<figure><img src="fig/good_formatting.png" alt="good formatting" class="figure mx-auto d-block"></figure></section><section id="formatting-pretty"><h2 class="section-heading">Using formatting to make the data sheet look pretty<a class="anchor" aria-label="anchor" href="#formatting-pretty"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: merging cells.</p>
<p><strong>Solution</strong>: If you’re not careful, formatting a
worksheet to be more aesthetically pleasing can compromise your
computer’s ability to see associations in the data. Merged cells will
make your data unreadable by statistics software. Consider restructuring
your data in such a way that you will not need to merge cells to
organize your data.</p>
</section><section id="units"><h2 class="section-heading">Placing comments or units in cells<a class="anchor" aria-label="anchor" href="#units"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: Your data was collected, in part, by a
summer student who you later found out was mis-identifying some of your
species, some of the time. You want a way to note these data are
suspect.</p>
<p><strong>Solution</strong>: Most analysis software can’t see Excel or
LibreOffice comments, and would be confused by comments placed within
your data cells. As described above for formatting, create another field
if you need to add notes to cells. Similarly, don’t include units in
cells: ideally, all the measurements you place in one column should be
in the same unit, but if for some reason they aren’t, create another
field and specify the units the cell is in.</p>
</section><section id="info"><h2 class="section-heading">Entering more than one piece of information in a cell<a class="anchor" aria-label="anchor" href="#info"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: You find one male, and one female of the
same species. You enter this as 1M, 1F.</p>
<p><strong>Solution</strong>: Don’t include more than one piece of
information in a cell. This will limit the ways in which you can analyze
your data. If you need both these measurements, design your data sheet
to include this information. For example, include one column for number
of individuals and a separate column for sex.</p>
</section><section id="field-name"><h2 class="section-heading">Using problematic field names<a class="anchor" aria-label="anchor" href="#field-name"></a>
</h2>
<hr class="half-width">
<p>Choose descriptive field names, but be careful not to include spaces,
numbers, or special characters of any kind. Spaces can be misinterpreted
by parsers that use whitespace as delimiters and some programs don’t
like field names that are text strings that start with numbers.</p>
<p>Underscores (<code>_</code>) are a good alternative to spaces.
Consider writing names in camel case (like this: ExampleFileName) to
improve readability. Remember that abbreviations that make sense at the
moment may not be so obvious in 6 months, but don’t overdo it with names
that are excessively long. Including the units in the field names avoids
confusion and enables others to readily interpret your fields.</p>
<p><strong>Examples</strong></p>
<table align="left" style="width =50%; border: 1px solid black;" class="table">
<tr>
<td>
<b>Good Name</b>
</td>
<br><td>
<b>Good Alternative </b>
</td>
<br><td>
<b>Avoid </b>
</td>
<br>
</tr>
<tr>
<td>
Max_temp_C
</td>
<td>
MaxTemp
</td>
<td>
Maximum Temp (°C)
</td>
</tr>
<tr>
<td>
Precipitation_mm
</td>
<td>
Precipitation
</td>
<td>
precmm
</td>
</tr>
<tr>
<td>
Mean_year_growth
</td>
<td>
MeanYearGrowth
</td>
<td>
Mean growth/year
</td>
</tr>
<tr>
<td>
sex
</td>
<td>
sex
</td>
<td>
M/F
</td>
</tr>
<tr>
<td>
weight
</td>
<td>
weight
</td>
<td>
w.
</td>
</tr>
<tr>
<td>
cell_type
</td>
<td>
CellType
</td>
<td>
Cell Type
</td>
</tr>
<tr>
<td>
Observation_01
</td>
<td>
first_observation
</td>
<td>
1st Obs
</td>
</tr>
</table></section><section id="special"><h2 class="section-heading">Using special characters in data<a class="anchor" aria-label="anchor" href="#special"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: You treat your spreadsheet program as a
word processor when writing notes, for example copying data directly
from Word or other applications.</p>
<p><strong>Solution</strong>: This is a common strategy. For example,
when writing longer text in a cell, people often include line breaks,
em-dashes, etc in their spreadsheet. Also, when copying data in from
applications such as Word, formatting and fancy non-standard characters
(such as left- and right-aligned quotation marks) are included. When
exporting this data into a coding/statistical environment or into a
relational database, dangerous things may occur, such as lines being cut
in half and encoding errors being thrown.</p>
<p>General best practice is to avoid adding characters such as newlines,
tabs, and vertical tabs. In other words, treat a text cell as if it were
a simple web form that can only contain text and spaces.</p>
</section><section id="metadata"><h2 class="section-heading">Inclusion of metadata in data table<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h2>
<hr class="half-width">
<p><strong>Example</strong>: You add a legend at the top or bottom of
your data table explaining column meaning, units, exceptions, etc.</p>
<p><strong>Solution</strong>: Recording data about your data
(“metadata”) is essential. You may be on intimate terms with your
dataset while you are collecting and analysing it, but the chances that
you will still remember that the variable “sglmemgp” means single member
of group, for example, or the exact algorithm you used to transform a
variable or create a derived one, after a few months, a year, or more
are slim.</p>
<p>As well, there are many reasons other people may want to examine or
use your data - to understand your findings, to verify your findings, to
review your submitted publication, to replicate your results, to design
a similar study, or even to archive your data for access and re-use by
others. While digital data by definition are machine-readable,
understanding their meaning is a job for human beings. The importance of
documenting your data during the collection and analysis phase of your
research cannot be overestimated, especially if your research is going
to be part of the scholarly record.</p>
<p>However, metadata should not be contained in the data file itself.
Unlike a table in a paper or a supplemental file, metadata (in the form
of legends) should not be included in a data file since this information
is not data, and including it can disrupt how computer programs
interpret your data file. Rather, metadata should be stored as a
separate file in the same directory as your data file, preferably in
plain text format with a name that clearly associates it with your data
file. Because metadata files are free text format, they also allow you
to encode comments, units, information about how null values are
encoded, etc. that are important to document but can disrupt the
formatting of your data file.</p>
<p>Additionally, file or database level metadata describes how files
that make up the dataset relate to each other; what format are they are
in; and whether they supercede or are superceded by previous files. A
folder-level readme.txt file is the classic way of accounting for all
the files and folders in a project.</p>
<p>(Text on metadata adapted from the online course Research Data <a href="https://datalib.edina.ac.uk/mantra" class="external-link">MANTRA</a> by EDINA and Data
Library, University of Edinburgh. MANTRA is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">Creative Commons
Attribution 4.0 International License</a>.)</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Avoid using multiple tables within one spreadsheet.</li>
<li>Avoid spreading data across multiple tabs.</li>
<li>Record zeros as zeros.</li>
<li>Use an appropriate null value to record missing data.</li>
<li>Don’t use formatting to convey information or to make your
spreadsheet look pretty.</li>
<li>Place comments in a separate column.</li>
<li>Record units in column headers.</li>
<li>Include only one piece of information in a cell.</li>
<li>Avoid spaces, numbers and special characters in column headers.</li>
<li>Avoid special characters in your data.</li>
<li>Record metadata in a separate plain text file.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-03-dates-as-data"><p>Content from <a href="03-dates-as-data.html">Dates as data</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/edit/main/episodes/03-dates-as-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are good approaches for handling dates in spreadsheets?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe how dates are stored and formatted in spreadsheets.</li>
<li>Describe the advantages of alternative date formatting in
spreadsheets.</li>
<li>Demonstrate best practices for entering dates in spreadsheets.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Dates in spreadsheets can be a problem. For one thing, dates are
stored in a single column. While this seems the most natural way to
record dates, it actually is not best practice. A spreadsheet
application will display the dates in a seemingly correct way (to a
human observer) but how it actually handles and stores the dates may be
problematic.</p>
<p>In particular, please remember that DATE functions that are valid for
a given spreadsheet program (be it LibreOffice Calc, Microsoft Excel,
OpenOffice, Gnumeric, etc.) are usually guaranteed to be compatible only
within the same family of products. Most of the images of spreadsheets
in this lesson come from Microsoft Excel, run on a Mac or on Windows.
Regardless of your spreadsheet, if you will later need to export the
data and <strong><em>need to conserve the timestamps</em></strong>, you
are better off handling them using one of the solutions discussed
below.</p>
<p>One of the big problems with Excel is it can <a href="https://nsaunders.wordpress.com/2012/10/22/gene-name-errors-and-excel-lessons-not-learned/" class="external-link">turn
things that aren’t dates into dates</a>, for example gene/protein names
or identifiers like MAR1, DEC1, OCT4 will be changed to dates, and you
cannot retreive the original name or identifier (except manually). So if
you avoid the date format overall, it’s easier to work with these types
of data. When you must work with dates, here is how to do it
efficiently.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>Challenge: pulling month, day and year out of dates</p>
<ul>
<li>Let’s create a tab called <code>dates</code> in our data spreadsheet
and copy the ‘plot 3’ table from the <code>2014</code> tab (that
contains the problematic dates).</li>
<li>Let’s extract month, day and year from the dates in the
<code>Date collected</code> column into new columns. For this we can use
the following built-in Excel functions:</li>
</ul>
<p><code>YEAR()</code></p>
<p><code>MONTH()</code></p>
<p><code>DAY()</code></p>
<p>(Make sure the new columns are formatted as a number and not as a
date.)</p>
<p>You can see that even though we expected the year to be 2014, the
year is actually 2015. What happened here is that the field assistant
who collected the data for year 2014 initially forgot to include their
data for ‘plot 3’ in this dataset. They came back in 2015 to add the
missing data into the dataset and entered the dates for ‘plot 3’ without
the year. Excel automatically interpreted the year as 2015 - the year
the data was entered into the spreadsheet and not the year the data was
collected. Thereby, the spreadsheet program introduced an error in the
dataset without the field assistant realising.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p><img src="fig/solution_exercise_1_dates.png" class="figure"> {alt=‘dates, exersize
1’ .output}</p>
</div>
</div>
</div>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>Challenge: pulling hour, minute and second out of the current
time</p>
<p>Current time and date are best retrieved using the functions
<code>NOW()</code>, which returns the current date and time, and
<code>TODAY()</code>, which returns the current date. The results will
be formatted according to your computer’s settings.</p>
<ol style="list-style-type: decimal">
<li>Extract the year, month and day from the current date and time
string returned by the <code>NOW()</code> function.</li>
<li>Calculate the current time using <code>NOW()-TODAY()</code>.</li>
<li>Extract the hour, minute and second from the current time using
functions <code>HOUR()</code>, <code>MINUTE()</code> and
<code>SECOND()</code>.</li>
<li>Press <code>F9</code> to force the spreadsheet to recalculate the
<code>NOW()</code> function, and check that it has been updated.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>To get the year, type <code>=YEAR(NOW())</code> into any cell in
your spreadsheet. To get the month, type <code>=MONTH(NOW())</code>. To
get the day, type <code>=DAY(NOW())</code>.</li>
<li>Typing <code>=NOW()-TODAY()</code> will result in a decimal value
that is not easily human parsable to a clock-based time. You will need
to use the strategies in the third part of this challenge to convert
this decimal value to readable time.</li>
<li>To extract the hour, type <code>=HOUR(NOW()-TODAY())</code> and
similarly for minute and second.</li>
</ol>
</div>
</div>
</div>
</div>
<section id="preferred-date-format"><h2 class="section-heading">Preferred date format<a class="anchor" aria-label="anchor" href="#preferred-date-format"></a>
</h2>
<hr class="half-width">
<p>It is much safer to store dates with <a href="#day">YEAR, MONTH,
DAY</a> in separate columns or as <a href="#doy">YEAR and
DAY-OF-YEAR</a> in separate columns.</p>
<p><strong>Note</strong>: Excel is unable to parse dates from before
1899-12-31, and will thus leave these untouched. If you’re mixing
historic data from before and after this date, Excel will translate only
the post-1900 dates into its internal format, thus resulting in mixed
data. If you’re working with historic data, be extremely careful with
your dates!</p>
<p>Excel also entertains a second date system, the 1904 date system, as
the default in Excel for Macintosh. This system will assign a different
serial number than the <a href="https://support.microsoft.com/en-us/help/214330/differences-between-the-1900-and-the-1904-date-system-in-excel" class="external-link">1900
date system</a>. Because of this, <a href="https://uc3.cdlib.org/2014/04/09/abandon-all-hope-ye-who-enter-dates-in-excel/" class="external-link">dates
must be checked for accuracy when exporting data from Excel</a> (look
for dates that are ~4 years off).</p>
</section><section id="date-formats-in-spreadsheets"><h2 class="section-heading">Date formats in spreadsheets<a class="anchor" aria-label="anchor" href="#date-formats-in-spreadsheets"></a>
</h2>
<hr class="half-width">
<p>Spreadsheet programs have numerous “useful features” which allow them
to handle dates in a variety of ways.</p>
<figure><img src="fig/5_excel_dates_1.jpg" alt="Many formats, many ambiguities" class="figure mx-auto d-block"></figure><p>But these “features” often allow ambiguity to creep into your data.
Ideally, data should be as unambiguous as possible.</p>
<div class="section level3">
<h3 id="dates-stored-as-integers">Dates stored as integers<a class="anchor" aria-label="anchor" href="#dates-stored-as-integers"></a>
</h3>
<p>The first thing you need to know is that Excel stores dates as
numbers - see the last column in the above figure. Essentially, it
counts the days from a default of December 31, 1899, and thus stores
July 2, 2014 as the serial number 41822.</p>
<p>(But wait. That’s the default on my version of Excel. We’ll get into
how this can introduce problems down the line later in this lesson.
)</p>
<p>This serial number thing can actually be useful in some
circumstances. By using the above functions we can easily add days,
months or years to a given date. Say you had a sampling plan where you
needed to sample every thirty seven days. In another cell, you could
type:</p>
<pre><code>=B2+37</code></pre>
<p>And it would return</p>
<pre><code><span><span class="fl">8</span><span class="op">-</span><span class="va">Aug</span></span></code></pre>
<p>because it understands the date as a number <code>41822</code>, and
<code>41822 + 37 = 41859</code> which Excel interprets as August 8,
2014. It retains the format (for the most part) of the cell that is
being operated upon, (unless you did some sort of formatting to the cell
before, and then all bets are off). Month and year rollovers are
internally tracked and applied.</p>
<p><strong>Note</strong> Adding years and months and days is slightly
trickier because we need to make sure that we are adding the amount to
the correct entity.</p>
<ul>
<li>First we extract the single entities (day, month or year)</li>
<li>We can then add values to do that</li>
<li>Finally the complete date string is reconstructed using the
<code>DATE()</code> function.</li>
</ul>
<p>As for dates, times are handled in a similar way; seconds can be
directly added but to add hour and minutes we need to make sure that we
are adding the quantities to the correct entities.</p>
<p>Which brings us to the many different ways Excel provides in how it
displays dates. If you refer to the figure above, you’ll see that there
are many ways that ambiguity creeps into your data depending on the
format you chose when you enter your data, and if you’re not fully aware
of which format you’re using, you can end up actually entering your data
in a way that Excel will badly misinterpret and you will end up with
errors in your data that will be extremely difficult to track down and
troubleshoot.</p>
<div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="callout-content">
<p>What happens to the dates in the <code>dates</code> tab of our
workbook if we save this sheet in Excel (in <code>csv</code> format) and
then open the file in a plain text editor (like TextEdit or Notepad)?
What happens to the dates if we then open the <code>csv</code> file in
Excel?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<ul>
<li>Click to the <code>dates</code> tab of the workbook and double-click
on any of the values in the <code>Date collected</code> column. Notice
that the dates display with the year 2015.</li>
<li>Select <code>File -&gt; Save As</code> in Excel and in the drop down
menu for file format select
<code>CSV UTF-8 (Comma delimited) (.csv)</code>. Click
<code>Save</code>.</li>
<li>You will see a pop-up that says “This workbook cannot be saved in
the selected file format because it contains multiple sheets.” Choose
<code>Save Active Sheet</code>.</li>
<li>Navigate to the file in your finder application. Right click and
select <code>Open With</code>. Choose a plain text editor application
and view the file. Notice that the dates display as month/day without
any year information.</li>
<li>Now right click on the file again and open with Excel. Notice that
the dates display with the current year, not 2015.<br>
As you can see, exporting data from Excel and then importing it back
into Excel fundamentally changed the data once again!</li>
</ul>
</div>
</div>
</div>
</div>
<p><strong>Note</strong><br>
You will notice that when exporting into a text-based format (such as
CSV), Excel will export its internal date integer instead of a useful
value (that is, the dates will be represented as integer numbers). This
can potentially lead to problems if you use other software to manipulate
the file.</p>
</div>
<div class="section level3">
<h3 id="advantages-of-alternative-date-formatting">Advantages of Alternative Date Formatting<a class="anchor" aria-label="anchor" href="#advantages-of-alternative-date-formatting"></a>
</h3>
</div>
<div class="section level3">
<h3 id="day">Storing dates as YEAR, MONTH, DAY<a class="anchor" aria-label="anchor" href="#day"></a>
</h3>
<p>Storing dates in YEAR, MONTH, DAY format helps remove this ambiguity.
Let’s look at this issue a bit closer.</p>
<p>For instance this is a spreadsheet representing insect counts that
were taken every few days over the summer, and things went something
like this:</p>
<figure><img src="fig/6_excel_dates_2.jpg" alt="So, so ambiguous, it's even confusing Excel" class="figure mx-auto d-block"></figure><p>If Excel was to be believed, this person had been collecting bugs
<strong>in the future</strong>. Now, we have no doubt this person is
highly capable, but I believe time travel was beyond even their
grasp.</p>
<p>Entering dates in one cell is helpful but due to the fact that the
spreadsheet programs may interpret and save the data in different ways
(doing that somewhat behind the scenes), there is a better practice.</p>
<p>In dealing with dates in spreadsheets, separate date data into
separate fields (day, month, year), which will eliminate any chance of
ambiguity.</p>
</div>
<div class="section level3">
<h3 id="doy">Storing dates as YEAR, DAY-OF-YEAR<a class="anchor" aria-label="anchor" href="#doy"></a>
</h3>
<p>There is also another option. You can also store dates as year and
day of year (DOY). Why? Because depending on your question, this might
be what’s useful to you, and there is practically no possibility for
ambiguity creeping in.</p>
<p>Statistical models often incorporate year as a factor, or a
categorical variable, rather than a numeric variable, to account for
year-to-year variation, and DOY can be used to measure the passage of
time within a year.</p>
<p>So, can you convert all your dates into DOY format? Well, in Excel,
here’s a useful guide:</p>
<figure><img src="fig/7_excel_dates_3.jpg" alt="Kill that ambiguity before it bites you!" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="str">Storing dates as a single string<a class="anchor" aria-label="anchor" href="#str"></a>
</h3>
<p>Another alternative could be to convert the date string into a single
string using the <code>YYYYMMDD</code> format. For example the date
<code>March 24, 2015</code> would become <code>20150324</code>. This
option also works for datetimes using the <code>YYYYMMDDhhmmss</code>
format. So the datetime <code>March 24, 2015 17:25:35</code> would
become <code>20150324172535</code>, where:</p>
<p>YYYY: the full year, i.e. 2015<br>
MM: the month, i.e. 03<br>
DD: the day of month, i.e. 24<br>
hh: hour of day, i.e. 17<br>
mm: minutes, i.e. 25<br>
ss: seconds, i.e. 35</p>
<p>Such strings will be correctly sorted in ascending or descending
order, and by knowing the format they can then be correctly processed by
the receiving software.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Treating dates as multiple pieces of data rather than one makes them
easier to handle.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-04-quality-control"><p>Content from <a href="04-quality-control.html">Quality control</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/edit/main/episodes/04-quality-control.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we carry out basic quality control and quality assurance in
spreadsheets?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Apply quality control techniques to identify errors in spreadsheets
and limit incorrect data entry.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>When you have a well-structured data table, you can use several
simple techniques within your spreadsheet to ensure the data you enter
is free of errors. These approaches include techniques that are
implemented prior to entering data (quality assurance) and techniques
that are used after entering data to check for errors (quality
control).</p>
<section id="quality-assurance"><h2 class="section-heading">Quality Assurance<a class="anchor" aria-label="anchor" href="#quality-assurance"></a>
</h2>
<hr class="half-width">
<p>Quality assurance stops bad data from ever being entered by checking
to see if values are valid during data entry. For example, if research
is being conducted at sites A, B, and C, then the value V (which is
right next to B on the keyboard) should never be entered. Likewise if
one of the kinds of data being collected is a count, only integers
greater than or equal to zero should be allowed.</p>
<p>To control the kind of data entered into a spreadsheet we use Data
Validation (Excel) or Validity (Libre Office Calc), to set the values
that can be entered in each data column.</p>
<p>1. Select the cells or column you want to validate</p>
<p>2. On the <code>Data</code> tab select
<code>Data Validation</code></p>
<figure><img src="fig/data_validation.png" alt="Image of Data Validation button on Data tab" class="figure mx-auto d-block"></figure><p>3. In the <code>Allow</code> box select the kind of data that should
be in the column. Options include whole numbers, decimals, lists of
items, dates, and other values.</p>
<figure><img src="fig/data_validation_window.png" alt="Image of Data Validation window" class="figure mx-auto d-block"></figure><p>4. After selecting an item enter any additional details. For example,
if you’ve chosen a list of values, enter a comma-delimited or semi-colon
list of allowable values in the <code>Source</code> box.</p>
<p>Let’s try this out by setting the plot column in our spreadsheet to
only allow plot values that are integers between 1 and 24.</p>
<ol style="list-style-type: decimal">
<li>Select the <code>plot_id</code> column</li>
<li>On the <code>Data</code> tab select
<code>Data Validation</code>
</li>
<li>In the <code>Allow</code> box select <code>Whole number</code>
</li>
<li>Set the minimum and maximum values to 1 and 24.</li>
</ol>
<figure><img src="fig/plot_validation.png" alt="Image of Data Validation window for validating plot values" class="figure mx-auto d-block"></figure><p>Now let’s try entering a new value in the plot column that isn’t a
valid plot. The spreadsheet stops us from entering the wrong value and
asks us if we would like to try again.</p>
<figure><img src="fig/invalid_value.png" alt="Image of error when trying to enter invalid data" class="figure mx-auto d-block"></figure><p>You can also customize the resulting message to be more informative
by entering your own message in the <code>Input Message</code> tab</p>
<figure><img src="fig/input_message.png" alt="Image of Input Message tab" class="figure mx-auto d-block"></figure><p>or allow invalid data to result in a warning rather than an error by
modifying the <code>Style</code> option on the <code>Error Alert</code>
tab.</p>
<figure><img src="fig/error_alert.png" alt="Image of Error Alert tab" class="figure mx-auto d-block"></figure><p>Quality assurance can make data entry easier as well as more robust.
For example, if you use a list of options to restrict data entry, the
spreadsheet will provide you with a drop-downlist of the available
items. So, instead of trying to remember how to spell <em>Dipodomys
spectabilis</em>, you can select the right option from the list.</p>
<figure><img src="fig/drop_down_list2.png" alt="Image of drop-down menu" class="figure mx-auto d-block"></figure></section><section id="quality-control"><h2 class="section-heading">Quality Control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h2>
<hr class="half-width">
<p>Tip: <em>Before doing any quality control operations, save your
original file with the formulas and a name indicating it is the original
data. Create a separate file with appropriate naming and versioning, and
ensure your data is stored as values and not as formulas. Because
formulas refer to other cells, and you may be moving cells around, you
may compromise the integrity of your data if you do not take this
step!</em></p>
<p>readMe (README) files: As you start manipulating your data files,
create a readMe document / text file to keep track of your files and
document your manipulations so that they may be easily understood and
replicated, either by your future self or by an independent researcher.
Your readMe file should document all of the files in your data set
(including documentation), describe their content and format, and lay
out the organizing principles of folders and subfolders. For each of the
separate files listed, it is a good idea to document the manipulations
or analyses that were carried out on those data. <a href="https://data.research.cornell.edu/content/readme" class="external-link">Cornell
University’s Research Data Management Service Group</a> provides
detailed guidelines for how to write a good readMe file, along with an
adaptable template.</p>
<div class="section level3">
<h3 id="sorting">Sorting<a class="anchor" aria-label="anchor" href="#sorting"></a>
</h3>
<p>Bad values often sort to the bottom or top of the column. For
example, if your data should be numeric, then alphabetical and null data
will group at the ends of the sorted data. Sort your data by each field,
one at a time. Scan through each column, but pay the most attention to
the top and the bottom of a column. If your dataset is well-structured
and does not contain formulas, sorting should never affect the integrity
of your dataset.</p>
<p><strong>Remember</strong> to expand your sort in order to prevent
data corruption. Expanding your sort ensures that the all the data in
one row move together instead of only sorting a single column in
isolation. Sorting by only a single column will scramble your data - a
single row will no longer represent an individual observation.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>We’ve combined all of the tables from the messy data into a single
table in a single tab. Download this semi-cleaned data file to your
computer: <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/blob/gh-pages/data/survey_sorting_exercise.xlsx?raw=true" class="external-link">survey_sorting_exercise</a></p>
<p>Once downloaded, sort the <code>Weight_grams</code> column in your
spreadsheet program from <code>Largest to Smallest</code>.</p>
<p>What do you notice?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Click the Sort button on the data tab in Excel. A pop-up will appear.
Make sure you select <code>Expand the selection</code>.</p>
<p><img src="fig/sorting_button.png" class="figure"> {alt=‘quality_control0,
exercise1’ .output}</p>
<p>The following window will display, choose the column you want to sort
as well as the sort order.</p>
<p><img src="fig/sorting_example.png" class="figure"> {alt=‘quality_control1,
exercise1’ .output}</p>
<p><strong>Note</strong> how the odd values sort to the top and bottom
of the tabular data. The cells containing no data values sort to the
bottom of the tabular data, while the cells where the letter “g” was
included can be found towards the top. This is a powerful way to check
your data for outliers and odd values.</p>
<p><img src="fig/sorting_solution_1.png" class="figure"> {alt=‘quality_control2,
exercise1’ .output}</p>
<p><img src="fig/sorting_solution_2.png" class="figure"> {alt=‘quality_control3,
exercise1’ .output}</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="conditional-formatting">Conditional formatting<a class="anchor" aria-label="anchor" href="#conditional-formatting"></a>
</h3>
<p>Conditional formatting basically can do something like color code
your values by some criteria or lowest to highest. This makes it easy to
scan your data for outliers.</p>
<p>Conditional formatting should be used with caution, but it can be a
great way to flag inconsistent values when entering data.</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Make sure the Weight_grams column is highlighted.</li>
<li>In the main Excel menu bar, click <code>Home</code> &gt;
<code>Conditional Formatting...</code> choose a formatting rule.</li>
<li>Apply any <code>2-Color Scale</code> formatting rule.</li>
<li>Now we can scan through and different colors will stand out. Do you
notice any strange values?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Cells that contain non-numerical values are not colored. This
includes both the cells where the letter “g” was included and the empty
cells. <img src="fig/conditional_formating.png" class="figure">
{alt=‘quality_control4, exercise2’ .output}</p>
</div>
</div>
</div>
</div>
<p>It is nice to be able to do these scans in spreadsheets, but we also
can do these checks in a programming language like R, or in OpenRefine
or SQL.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Always copy your original spreadsheet file and work with a copy so
you don’t affect the raw data.</li>
<li>Use data validation to prevent accidentally entering invalid
data.</li>
<li>Use sorting to check for invalid data.</li>
<li>Use conditional formatting (cautiously) to check for invalid
data.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-05-exporting-data"><p>Content from <a href="05-exporting-data.html">Exporting data</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/edit/main/episodes/05-exporting-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we export data from spreadsheets in a way that is useful for
downstream applications?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Store spreadsheet data in universal file formats.</li>
<li>Export data from a spreadsheet to a CSV file.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Storing the data you’re going to work with for your analyses in Excel
default file format (<code>*.xls</code> or <code>*.xlsx</code> -
depending on the Excel version) isn’t a good idea. Why?</p>
<ul>
<li><p>Because it is a proprietary format, and it is possible that in
the future, technology won’t exist (or will become sufficiently rare) to
make it inconvenient, if not impossible, to open the file.</p></li>
<li><p>Other spreadsheet software may not be able to open files saved in
a proprietary Excel format.</p></li>
<li><p>Different versions of Excel may handle data differently, leading
to inconsistencies.</p></li>
<li><p>Finally, more journals and grant agencies are requiring you to
deposit your data in a data repository, and most of them don’t accept
Excel format. It needs to be in one of the formats discussed
below.</p></li>
<li><p>The above points also apply to other formats such as open data
formats used by LibreOffice / Open Office. These formats are not static
and do not get parsed the same way by different software
packages.</p></li>
</ul>
<p>As an example of inconsistencies in data storage, do you remember how
we talked about how Excel stores dates earlier? It turns out that there
are multiple defaults for different versions of the software, and you
can switch between them all. So, say you’re compiling Excel-stored data
from multiple sources. There are dates in each file - Excel interprets
them as their own internally consistent serial numbers. When you combine
the data, Excel will take the serial number from the place you’re
importing it from, and interpret it using the rule set for the version
of Excel you’re using. Essentially, you could be adding errors to your
data, and it wouldn’t necessarily be flagged by any data cleaning
methods if your ranges overlap.</p>
<p>Storing data in a universal, open, and static format will help deal
with this problem. Try tab-delimited (tab separated values or TSV) or
comma-delimited (comma separated values or CSV). CSV files are plain
text files where the columns are separated by commas, hence ‘comma
separated values’ or CSV. The advantage of a CSV file over an
Excel/SPSS/etc. file is that we can open and read a CSV file using just
about any software, including plain text editors like TextEdit or
NotePad. Data in a CSV file can also be easily imported into other
formats and environments, such as SQLite and R. We’re not tied to a
certain version of a certain expensive program when we work with CSV
files, so it’s a good format to work with for maximum portability and
endurance. Most spreadsheet programs can save to delimited text formats
like CSV easily, although they may give you a warning during the file
export.</p>
<p>To save a file you have opened in Excel in CSV format:</p>
<ol style="list-style-type: decimal">
<li>From the top menu select ‘File’ and ‘Save as’.</li>
<li>In the ‘Format’ field, from the list, select ‘Comma Separated
Values’ (<code>*.csv</code>).</li>
<li>Double check the file name and the location where you want to save
it and hit ‘Save’.</li>
</ol>
<p>An important note for backwards compatibility: you can open CSV files
in Excel!</p>
<figure><img src="fig/excel-to-csv.png" alt="Saving an Excel file to CSV" class="figure mx-auto d-block"></figure><section id="a-note-on-cross-platform-operability"><h2 class="section-heading">A Note on Cross-platform Operability<a class="anchor" aria-label="anchor" href="#a-note-on-cross-platform-operability"></a>
</h2>
<hr class="half-width">
<p>By default, most coding and statistical environments expect
UNIX-style line endings (ASCII <code>LF</code> character) as
representing line breaks. However, Windows uses an alternate line ending
signifier (ASCII <code>CR LF</code> characters) by default for legacy
compatibility with Teletype-based systems.</p>
<p>As such, when exporting to CSV using Excel, your data in text format
will look like this:</p>
<blockquote>
<p>data1,data2<cr><lf>1,2<cr><lf>4,5<cr><lf></lf></cr></lf></cr></lf></cr></p>
</blockquote>
<p>When opening your CSV file in Excel again, it will parse it as
follows:</p>
<figure><img width="307" alt="screen shot 2017-03-31 at 7 15 07 pm" src="https://cloud.githubusercontent.com/assets/13110354/24560663/db4a5786-1643-11e7-931a-ca2c72336878.png" class="figure mx-auto d-block"></figure><p>However, if you open your CSV file on a different system that does
not parse the <code>CR</code> character it will interpret your CSV file
differently:</p>
<p>Your data in text format then look like this:</p>
<blockquote>
<p>data1<br> data2<cr><br> 1<br> 2<cr><br> …</cr></cr></p>
</blockquote>
<p>You will then see a weird character or possibly the string
<code>CR</code> or <code>\r</code>:</p>
<figure><img width="308" alt="screen shot 2017-03-31 at 7 26 42 pm" src="https://cloud.githubusercontent.com/assets/13110354/24561066/a990327c-1645-11e7-90b5-35a44e90f8d9.png" class="figure mx-auto d-block"></figure><p>thus causing terrible things to happen to your data. For example,
<code>2\r</code> is not a valid integer, and thus will throw an error
(if you’re lucky) when you attempt to operate on it in R or Python. Note
that this happens on Excel for OSX as well as Windows, due to legacy
Windows compatibility.</p>
<p>There are a handful of solutions for enforcing uniform UNIX-style
line endings on your exported CSV files:</p>
<ol style="list-style-type: decimal">
<li><p>When exporting from Excel, save as a “Windows comma separated
(.csv)” file</p></li>
<li><p>If you store your data file under version control using Git, edit
the <code>.git/config</code> file in your repository to automatically
translate <code>\r\n</code> line endings into <code>\n</code>. Add the
following to the file (<a href="https://nicercode.github.io/blog/2013-04-30-excel-and-line-endings" class="external-link">see
the detailed tutorial</a>):</p></li>
</ol>
<pre><code> [filter "cr"]
 	clean = LC_CTYPE=C awk '{printf(\"%s\\n\", $0)}' | LC_CTYPE=C tr '\\r' '\\n'
 	smudge = tr '\\n' '\\r'` </code></pre>
<p>and then create a file <code>.gitattributes</code> that contains the
line:</p>
<pre><code> *.csv filter=cr</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Use <a href="https://dos2unix.sourceforge.net/" class="external-link">dos2unix</a>
(available on OSX, *nix, and Cygwin) on local files to standardize line
endings.</li>
</ol>
<div class="section level4">
<h4 id="a-note-on-r-and--xlsx">A note on R and <code>.xlsx</code>
<a class="anchor" aria-label="anchor" href="#a-note-on-r-and--xlsx"></a>
</h4>
<p>There are R packages that can read <code>.xls</code> or
<code>.xlsx</code> files (as well as Google spreadsheets). It is even
possible to access different worksheets in the <code>.xlsx</code>
documents.</p>
<p><strong>But</strong></p>
<ul>
<li>some of these only work on Windows</li>
<li>this equates to replacing a (simple but manual) export to
<code>csv</code> with additional complexity/dependencies in the data
analysis R code</li>
<li>data formatting best practice still apply</li>
<li>Is there really a good reason why <code>csv</code> (or similar) is
not adequate?</li>
</ul>
</div>
<div class="section level4">
<h4 id="caveats-on-commas">Caveats on commas<a class="anchor" aria-label="anchor" href="#caveats-on-commas"></a>
</h4>
<p>In some datasets, the data values themselves may include commas (,).
This is particularly true in countries that use commas as decimal
separators. In that case, the software which you use (including Excel)
will most likely incorrectly display the data in columns. This is
because the commas which are a part of the data values will be
interpreted as delimiters.</p>
<p>If you are working with data that contains commas, you likely will
need to use another delimiter when working in a spreadsheet. In this
case, consider using tabs as your delimiter and working with TSV files.
TSV files can be exported from spreadsheet programs in the same way as
CSV files. For more of a discussion on data formats and potential issues
with commas within datasets see <a href="https://www.datacarpentry.org/spreadsheet-ecology-lesson/discuss/" class="external-link">the
discussion page</a>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Data stored in common spreadsheet formats will often not be read
correctly into data analysis software, introducing errors into your
data.</li>
<li>Exporting data from spreadsheets to formats like CSV or TSV puts it
in a format that can be used consistently by most programs.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.12.4" class="external-link">sandpaper (0.12.4)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/0.6.0" class="external-link">pegboard (0.6.0)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.2.18" class="external-link">varnish (0.2.18)</a>.</p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.github.io/spreadsheet-ecology-lesson/aio.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/spreadsheet-ecology-lesson/aio.html",
  "identifier": "https://datacarpentry.github.io/spreadsheet-ecology-lesson/aio.html",
  "dateCreated": "2015-03-09",
  "dateModified": "2023-09-05",
  "datePublished": "2023-09-05"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

